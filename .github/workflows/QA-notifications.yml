name: CI Pipeline - QA Alerts

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "**" ]

jobs:
  qa-validation:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run QA Test Script
        id: run_tests
        run: |
          chmod +x ./qa-test.sh
          ./qa-test.sh

      # ðŸš¨ QA FAILURE EMBED
      - name: Notify QA - Code Break
        if: failure()
        uses: tsickert/discord-webhook@v5
        with:
          webhook-url: ${{ secrets.DISCORD_QA_WEBHOOK_URL }}
          content: "<@&1461638033068785798>"
          embed-title: "ðŸš¨ QA ALERT: Code Break"
          embed-description: |
            The automated QA script **reported an error**.
          embed-color: 15158332
          embed-url: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
          embed-footer-text: "GitHub Actions"
          embed-fields: |
            Repository,${{ github.repository }},true
            Branch,${{ github.ref_name }},true
            Run ID,${{ github.run_id }},true

      # âœ… QA SUCCESS EMBED
      - name: Notify QA - Success
        if: success()
        uses: tsickert/discord-webhook@v5
        with:
          webhook-url: ${{ secrets.DISCORD_QA_WEBHOOK_URL }}
          embed-title: "âœ… QA Check Passed"
          embed-description: |
            The QA test script completed **successfully**.
          embed-color: 3066993
          embed-url: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
          embed-footer-text: "GitHub Actions"
          embed-fields: |
            Repository,${{ github.repository }},true
            Branch,${{ github.ref_name }},true
            Run ID,${{ github.run_id }},true